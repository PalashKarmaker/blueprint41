// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 15.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace Blueprint41.Modeller.Generation
{
    using System;
    using System.Text;
    using System.IO;
    using System.Linq;
    using System.Collections;
    using System.Collections.Generic;
    using Blueprint41.Modeller.Schemas;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "15.0.0.0")]
    internal partial class DatastoreModel : GenerationBase
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            
            #line 9 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 foreach (var functionalId in FunctionalIds)
{

            
            #line default
            #line hidden
            
            #line 12 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 if(functionalId.Name != "None") 
{

            
            #line default
            #line hidden
            this.Write("\t\t\tFunctionalId ");
            
            #line 15 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
functionalId.Name.ToLower();
            
            #line default
            #line hidden
            this.Write("Id = FunctionalIds.New(\"");
            
            #line 15 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(functionalId.Name));
            
            #line default
            #line hidden
            this.Write("\", \"");
            
            #line 15 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(functionalId.Value));
            
            #line default
            #line hidden
            this.Write("\", IdFormat.");
            
            #line 15 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(functionalId.Type));
            
            #line default
            #line hidden
            this.Write(", 0);\r\n");
            
            #line 16 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

} 

            
            #line default
            #line hidden
            
            #line 19 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 
}

            
            #line default
            #line hidden
            this.Write("\t\t\r\n");
            
            #line 23 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

	foreach (var entity in Entities.OrderBy(x => x.Name))
    {

            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 27 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write(" =");
            
            #line 28 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

		if(string.IsNullOrEmpty(entity.Inherits))
        {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\tEntities.New(\"");
            
            #line 32 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("\")");

            #line 33 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

                }
		else
        {

            
            #line default
            #line hidden
            
            #line 38 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			 string name = Modeller.Model.Entities.Entity.Where(x => x.Guid == entity.Inherits).First().Name;

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\tEntities.New(\"");
            
            #line 41 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("\", ");
            
            #line 41 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(name));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 42 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

					if(!string.IsNullOrEmpty(entity.Summary))
					{
				
            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.Summary(\"");
            
            #line 46 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Summary.Replace("\"", "\\\"")));
            
            #line default
            #line hidden
            this.Write("\")");
            
            #line 47 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

					}
		}
		if(entity.Abstract)
        {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.Abstract(true)");
            
            #line 54 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

        }
		if(entity.Virtual)
        {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.Virtual(true)");
            
            #line 60 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

        }

            
            #line default
            #line hidden
            
            #line 63 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

        foreach (var primitive in entity.Primitive)
        {
			if(!string.IsNullOrEmpty(primitive.Index) && !primitive.Index.Equals("None"))
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.AddProperty(\"");
            
            #line 69 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Name));
            
            #line default
            #line hidden
            this.Write("\", typeof(");
            
            #line 69 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Type));
            
            #line default
            #line hidden
            this.Write("), ");
            
            #line 69 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(!primitive.Nullable?"false,":""));
            
            #line default
            #line hidden
            this.Write(" IndexType.");
            
            #line 69 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Index));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 70 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

            }
			else
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.AddProperty(\"");
            
            #line 75 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Name));
            
            #line default
            #line hidden
            this.Write("\", typeof(");
            
            #line 75 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Type));
            
            #line default
            #line hidden
            this.Write(") ");
            
            #line 75 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(!primitive.Nullable?",false":""));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 76 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

            }
			if(primitive.IsKey)
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.SetKey(\"");
            
            #line 81 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Name));
            
            #line default
            #line hidden
            this.Write("\", true)");

            #line 82 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

            }
        }

            
            #line default
            #line hidden
           
            // this.Write("       \r\n");
            
            #line 86 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

		    Write(string.Join($"{Environment.NewLine}", entity.Primitive.Where(x => x.IsFullTextProperty == true).Select(x =>".SetFullTextProperty(\""+ x.Name+"\")").ToList()));
 
            
            #line default
            #line hidden
            
            #line 91 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

            Write(";\r\n");

            
            #line default
            #line hidden
            this.Write("\t\t\t\r\n");
            
            #line 95 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

    foreach (var relationship in entity.GetRelationships(RelationshipDirection.In, false))
    {
		bool hasRelationshipSourceName = string.IsNullOrEmpty(relationship.Source.Name);
		bool hasRelationshipTargetName = string.IsNullOrEmpty(relationship.Target.Name);

            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 101 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Name));
            
            #line default
            #line hidden
            this.Write(" = \r\n");
            
            #line 102 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"


		if(string.IsNullOrEmpty(relationship.Name))
        {

            
            #line default
            #line hidden
            this.Write("\t\t\t\tRelations.New(");
            
            #line 107 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Label));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 107 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Label));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 107 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Type));
            
            #line default
            #line hidden
            this.Write(")\r\n");
            
            #line 108 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

		}
		else
        {

            
            #line default
            #line hidden
            this.Write("\t\t\t\tRelations.New(");
            
            #line 113 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Label));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 113 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Label));
            
            #line default
            #line hidden
            this.Write(", \"");
            
            #line 113 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Name));
            
            #line default
            #line hidden
            this.Write("\", \"");
            
            #line 113 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Type));
            
            #line default
            #line hidden
            this.Write("\")");
            
            #line 113 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
if(hasRelationshipSourceName){Write(";");}
            
            #line default
            #line hidden
            
            #line 114 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

        }
		if(!hasRelationshipSourceName)
        {
			if(relationship.Source.Nullable)
            {

            
            #line default
            #line hidden
            this.Write("\t\t\t\t\r\n\t\t\t\t\t.SetInProperty(\"");
            
            #line 122 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Name));
            
            #line default
            #line hidden
            this.Write("\", PropertyType.");
            
            #line 122 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Type));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 122 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
if(hasRelationshipTargetName){Write(";\r\n");}
            
            #line default
            #line hidden
            
            #line 123 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			}
			else
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t.SetInProperty(\"");
            
            #line 129 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Name));
            
            #line default
            #line hidden
            this.Write("\", PropertyType.");
            
            #line 129 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Type));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 129 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Nullable.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 129 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
if(hasRelationshipTargetName){Write(";\r\n");}
            
            #line default
            #line hidden
            
            #line 130 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

            }
		}
		if(!hasRelationshipTargetName)
        {
			if(relationship.Target.Nullable)
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t.SetOutProperty(\"");
            
            #line 139 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Name));
            
            #line default
            #line hidden
            this.Write("\", PropertyType.");
            
            #line 139 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Type));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 140 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
			
			}
			else
			{

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t.SetOutProperty(\"");
            
            #line 146 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Name));
            
            #line default
            #line hidden
            this.Write("\", PropertyType.");
            
            #line 146 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Type));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 146 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Nullable.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 147 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			}
		}
		else
        {
		}

                    this.Write("\r\n");
                }

            
            #line default
            #line hidden
            
            #line 155 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

    }

            
            #line default
            #line hidden
            
            #line 158 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

	foreach (var entity in Entities.OrderBy(x => x.Name))
    {

            
            #line default
            #line hidden
            this.Write("\t\t\tpublic Entity ");
            
            #line 162 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write(" { get; private set; }\r\n\r\n\t\t");
            
            #line 164 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 if (entity.GetRelationships(RelationshipDirection.In, false).Count() > 0)
     {
		
            
            #line default
            #line hidden
            this.Write("\t\t\r\n\t\t");
            
            #line 168 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 foreach (var relationship in entity.GetRelationships(RelationshipDirection.In, false))
		{ 
            
            #line default
            #line hidden
            this.Write("\tpublic Relationship ");
            
            #line 170 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Name));
            
            #line default
            #line hidden
            this.Write(" { get; private set; }\r\n\t\t");
            
            #line 171 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 
		} 
            
            #line default
            #line hidden
            this.Write("\t\t\r\n\t\t");
            
            #line 174 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 
		} 
            
            #line default
            #line hidden
            
            #line 176 "E:\_tfs\BS.GBM\trunk (core 2.0)\code\Blueprint41.Modeller\Generation\DatastoreModel.tt"

    }

            
            #line default
            #line hidden
            this.Write("\t");
            return this.GenerationEnvironment.ToString();
        }
    }
    
    #line default
    #line hidden
}

// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool.
//     Runtime Version: 15.0.0.0
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
// ------------------------------------------------------------------------------
namespace Blueprint41.Modeller.Generation
{
    using System;
    using System.Text;
    using System.IO;
    using System.Linq;
    using System.Collections;
    using System.Collections.Generic;
    using Blueprint41.Modeller.Schemas;
    
    /// <summary>
    /// Class to produce the template output
    /// </summary>
    
    #line 1 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
    [global::System.CodeDom.Compiler.GeneratedCodeAttribute("Microsoft.VisualStudio.TextTemplating", "15.0.0.0")]
    internal partial class DatastoreModel : GenerationBase
    {
#line hidden
        /// <summary>
        /// Create the template output
        /// </summary>
        public override string TransformText()
        {
            
            #line 9 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 foreach (var functionalId in FunctionalIds)
{

            
            #line default
            #line hidden
            this.Write("\t\t\tFunctionalId ");
            
            #line 12 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(functionalId.Name.ToLower()));
            
            #line default
            #line hidden
            this.Write("Id = FunctionalIds.New(\"");
            
            #line 12 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(functionalId.Name));
            
            #line default
            #line hidden
            this.Write("\", \"");
            
            #line 12 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(functionalId.Value));
            
            #line default
            #line hidden
            this.Write("\", IdFormat.");
            
            #line 12 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(functionalId.Type));
            
            #line default
            #line hidden
            this.Write(", 0);\r\n");
            
            #line 13 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 
}

            
            #line default
            #line hidden
            this.Write("\t\t\r\n");
            
            #line 17 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

	foreach (var entity in Entities.OrderBy(x => x.Name))
    {

            
            #line default
            #line hidden
            this.Write("\t\t\t");
            
            #line 21 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write(" =\r\n");
            
            #line 22 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

		if(string.IsNullOrEmpty(entity.Inherits))
        {
			if (string.IsNullOrEmpty(entity.FunctionalId))
			{

            
            #line default
            #line hidden
            this.Write("\t\t\t\tEntities.New(\"");
            
            #line 28 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("\")");
            
            #line 28 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			}
			else
			{
				string entityFunctionalId = FunctionalIds.Where(x => x.Guid == entity.FunctionalId).First().Name.ToLower();

            
            #line default
            #line hidden
            this.Write("\t\t\t\tEntities.New(\"");
            
            #line 34 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("\", ");
            
            #line 34 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(string.Concat(entityFunctionalId, "Id")));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 34 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			}
        }
		else
        {

            
            #line default
            #line hidden
            
            #line 40 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			string name = Modeller.Model.Entities.Entity.Where(x => x.Guid == entity.Inherits).First().Name;
			
			if(string.IsNullOrEmpty(entity.FunctionalId))
			{

            
            #line default
            #line hidden
            this.Write("\t\t\t\tEntities.New(\"");
            
            #line 46 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("\", ");
            
            #line 46 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(name));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 46 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			}
			else
            {
				string entityFunctionalId = FunctionalIds.Where(x => x.Guid == entity.FunctionalId).First().Name.ToLower();

            
            #line default
            #line hidden
            this.Write("\t\t\t\tEntities.New(\"");
            
            #line 52 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write("\", ");
            
            #line 52 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(string.Concat(entityFunctionalId, "Id")));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 52 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(name));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 52 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
				
			}

			if(!string.IsNullOrEmpty(entity.Summary))
			{

            
            #line default
            #line hidden
            this.Write("\t\t\t\t\r\n\t\t\t\t.Summary(\"");
            
            #line 59 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Summary.Replace("\"", "\\\"")));
            
            #line default
            #line hidden
            this.Write("\")\r\n");
            
            #line 60 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			}
        }
		if(entity.Abstract)
        {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.Abstract(true)\r\n");
            
            #line 68 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

        }
		if(entity.Virtual)
        {

            
            #line default
            #line hidden
            this.Write("\t\t\t\t.Virtual(true)");
            
            #line 73 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

        }

            
            #line default
            #line hidden
            
            #line 76 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

        foreach (var primitive in entity.Primitive)
        {
			if(!string.IsNullOrEmpty(primitive.Index) && !primitive.Index.Equals("None"))
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.AddProperty(\"");
            
            #line 83 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Name));
            
            #line default
            #line hidden
            this.Write("\", typeof(");
            
            #line 83 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Type));
            
            #line default
            #line hidden
            this.Write("), ");
            
            #line 83 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(!primitive.Nullable?"false,":""));
            
            #line default
            #line hidden
            this.Write(" IndexType.");
            
            #line 83 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Index));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 83 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

            }
			else
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.AddProperty(\"");
            
            #line 89 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Name));
            
            #line default
            #line hidden
            this.Write("\", typeof(");
            
            #line 89 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Type));
            
            #line default
            #line hidden
            this.Write(") ");
            
            #line 89 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(!primitive.Nullable?",false":""));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 89 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

            }
			if(primitive.IsKey)
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t.SetKey(\"");
            
            #line 95 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(primitive.Name));
            
            #line default
            #line hidden
            this.Write("\", true)");
            
            #line 95 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			}
        }

		Write(string.Join($"{Environment.NewLine}", entity.Primitive.Where(x => x.IsFullTextProperty == true).Select(x =>".SetFullTextProperty(\""+ x.Name+"\")").ToList()));
		Write(";");

            
            #line default
            #line hidden
            this.Write("\t\t\t\r\n");
            
            #line 103 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

    foreach (var relationship in entity.GetRelationships(RelationshipDirection.In, false))
    {
		bool hasRelationshipSourceName = string.IsNullOrEmpty(relationship.Source.Name);
		bool hasRelationshipTargetName = string.IsNullOrEmpty(relationship.Target.Name);

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t");
            
            #line 110 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Name));
            
            #line default
            #line hidden
            this.Write(" = \r\n");
            
            #line 111 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"


		if(string.IsNullOrEmpty(relationship.Name))
        {

            
            #line default
            #line hidden
            this.Write("\t\t\t\tRelations.New(");
            
            #line 116 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Label));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 116 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Label));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 116 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Type));
            
            #line default
            #line hidden
            this.Write(")\r\n");
            
            #line 117 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

		}
		else
        {

            
            #line default
            #line hidden
            this.Write("\t\t\t\tRelations.New(");
            
            #line 122 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Label));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 122 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Label));
            
            #line default
            #line hidden
            this.Write(", \"");
            
            #line 122 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Name));
            
            #line default
            #line hidden
            this.Write("\", \"");
            
            #line 122 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Type));
            
            #line default
            #line hidden
            this.Write("\")");
            
            #line 122 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
if(hasRelationshipSourceName){Write(";");}
            
            #line default
            #line hidden
            
            #line 123 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

        }
		if(!hasRelationshipSourceName)
        {
			if(relationship.Source.Nullable)
            {

            
            #line default
            #line hidden
            this.Write("\t\t\t\t\r\n\t\t\t\t\t.SetInProperty(\"");
            
            #line 131 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Name));
            
            #line default
            #line hidden
            this.Write("\", PropertyType.");
            
            #line 131 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Type));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 131 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
if(hasRelationshipTargetName){Write(";\r\n");}
            
            #line default
            #line hidden
            
            #line 132 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			}
			else
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t.SetInProperty(\"");
            
            #line 138 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Name));
            
            #line default
            #line hidden
            this.Write("\", PropertyType.");
            
            #line 138 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Type));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 138 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Source.Nullable.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(")");
            
            #line 138 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
if(hasRelationshipTargetName){Write(";\r\n");}
            
            #line default
            #line hidden
            
            #line 139 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

            }
		}
		if(!hasRelationshipTargetName)
        {
			if(relationship.Target.Nullable)
            {

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t.SetOutProperty(\"");
            
            #line 148 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Name));
            
            #line default
            #line hidden
            this.Write("\", PropertyType.");
            
            #line 148 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Type));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 149 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
			
			}
			else
			{

            
            #line default
            #line hidden
            this.Write("\r\n\t\t\t\t\t.SetOutProperty(\"");
            
            #line 155 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Name));
            
            #line default
            #line hidden
            this.Write("\", PropertyType.");
            
            #line 155 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Type));
            
            #line default
            #line hidden
            this.Write(", ");
            
            #line 155 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Target.Nullable.ToString().ToLower()));
            
            #line default
            #line hidden
            this.Write(");\r\n");
            
            #line 156 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

			}
		}
		else
        {
		}
     }

            
            #line default
            #line hidden
            this.Write("\r\n");
            
            #line 165 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

    }

            
            #line default
            #line hidden
            
            #line 168 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

	foreach (var entity in Entities.OrderBy(x => x.Name))
    {

            
            #line default
            #line hidden
            this.Write("\t\t\tpublic Entity ");
            
            #line 172 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(entity.Name));
            
            #line default
            #line hidden
            this.Write(" { get; private set; }\r\n\r\n\t\t");
            
            #line 174 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 if (entity.GetRelationships(RelationshipDirection.In, false).Count() > 0)
     {
		
            
            #line default
            #line hidden
            this.Write("\t\t\r\n\t\t");
            
            #line 178 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 foreach (var relationship in entity.GetRelationships(RelationshipDirection.In, false))
		{ 
            
            #line default
            #line hidden
            this.Write("\tpublic Relationship ");
            
            #line 180 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
            this.Write(this.ToStringHelper.ToStringWithCulture(relationship.Name));
            
            #line default
            #line hidden
            this.Write(" { get; private set; }\r\n\t\t");
            
            #line 181 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 
		} 
            
            #line default
            #line hidden
            this.Write("\t\t\r\n\t\t");
            
            #line 184 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"
 
		} 
            
            #line default
            #line hidden
            
            #line 186 "D:\_Xirqlz\blueprint41\Blueprint41.Modeller\Generation\DatastoreModel.tt"

    }

            
            #line default
            #line hidden
            this.Write("\t");
            return this.GenerationEnvironment.ToString();
        }
    }
    
    #line default
    #line hidden
}
